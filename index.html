<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>psd by abarbour</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>psd</h1>
        <p>Adaptive sine-multitaper power spectral density estimation in R</p>

<p>We have published a paper in Computers & Geosciences
(<a href="http://dx.doi.org/10.1016/j.cageo.2013.09.015" target="_blank">here</a>)
to accompany this software; it describes the theory behind
the estimation process, and how we apply it in practice.</p>

 <p class="view">
View the Project on
<br>
<a href="http://cran.r-project.org/web/packages/psd/" target="_blank"> CRAN<small>psd</small></a>
or on
<a href="https://github.com/abarbour/psd" target="_blank"> GitHub<small>abarbour/psd</small></a>
which can be download as a zipball or tarball:
</p>
        <ul>
          <li><a href="https://github.com/abarbour/psd/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/abarbour/psd/tarball/master">Download <strong>TAR Ball</strong></a></li>
 <!--
<li><a href="https://github.com/abarbour/psd" target="_blank">Development at<strong>GitHub</strong></a></li>
-->
        </ul>

      </header>
      <section>
        <h1>
<a name="psd-adaptive-sine-multitaper-power-spectral-density-estimation-in-r" class="anchor" href="#psd-adaptive-sine-multitaper-power-spectral-density-estimation-in-r"><span class="octicon octicon-link"></span></a>psd: Adaptive, sine multitaper power spectral density estimation in R</h1>

<h2>
<a name="by-andrew-j-barbour-and-robert-l-parker" class="anchor" href="#by-andrew-j-barbour-and-robert-l-parker"><span class="octicon octicon-link"></span></a>by Andrew J Barbour and Robert L Parker</h2>

<h3>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h3>

<p>This is an <code>R</code>
package for computing univariate power spectral density
estimates with little or no tuning effort.
We employ sine multitapers, allowing the number to vary with frequency
in order to reduce mean square error, the sum of squared bias and
variance, at each point.  The approximate criterion of
<a href="http://dx.doi.org/10.1109/78.365298" target="_blank">Riedel and Sidorenko (1995)</a>
is modified to prevent runaway averaging that otherwise occurs when
the curvature of the spectrum goes to zero.  An iterative procedure
refines the number of tapers employed at each frequency.  The resultant
power spectra possess significantly lower variances 
than those of traditional, non-adaptive estimators.  The sine tapers also provide
useful spectral leakage suppression.  Resolution and uncertainty can
be estimated from the number of degrees of freedom (twice the number
of tapers).</p>

<p>This technique is particularly suited to long time series, because
it demands only one numerical Fourier transform, and requires no
costly additional computation of taper functions, like the Slepian
functions.  It also avoids the degradation of the low-frequency
performance associated with record segmentation 
in Welch's method.
Above all, the adaptive process relieves the user of the need to set
a tuning parameter, such as time-bandwidth product or segment length,
that fixes frequency resolution for the entire frequency interval; instead
it provides frequency-dependent spectral resolution tailored to the
shape of the spectrum itself.</p>

<p><code>psd</code> elegantly handles
spectra with large dynamic range and mixed-bandwidth features|features
typically found in geophysical datasets.  </p>

<h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>Firstly you'll need to install the package and it's dependencies
from <a href="http://cran.r-project.org/web/packages/psd/" target="_blank">CRAN</a>
(from within the <code>R</code> environment):</p>

<pre><code>install.packages("psd", dependencies=TRUE)
</code></pre>

<p>then load the package library</p>

<pre><code>library(psd)
</code></pre>

<p>We have included a dataset to play with, named <code>Tohoku</code>, which represents
recordings of
high-frequency borehole strainmeter data during
teleseismic waves from the 2011 Mw 9.0 Tohoku 
earthquake (<a href="http://goo.gl/Gx7Ww" target="_blank">source</a>).
Access and inspect these data with:</p>

<pre><code>data(Tohoku)
print(str(Tohoku))
</code></pre>

<p>The 'preseismic' data has interesting spectral features, so we
subset it, and use the areal strain (the change in borehole
diameter):</p>

<pre><code>Dat &lt;- subset(Tohoku, epoch=="preseismic")
Areal &lt;- ts(Dat$areal)
</code></pre>

<p>For the purposes of spectral estimation, we remove a linear trend:</p>

<pre><code>Dat &lt;- prewhiten(Areal, plot=FALSE)
</code></pre>

<p>Now we can calculate the adaptive PSD:</p>

<pre><code>mtpsd &lt;- pspectrum(Dat$prew_lm, plot=TRUE)
print(class(mtpsd))
</code></pre>

<p>We can visualize the spectrum with built-in methods:</p>

<pre><code>plot(mtpsd, log="dB")
</code></pre>

<p>and the spectral uncertainty:</p>

<pre><code>sprop &lt;- spectral_properties(mtpsd)
Ntap &lt;- sprop$taper/max(sprop$taper)
plot(Ntap, type="h", ylim=c(0,2), col="dark grey") 
lines(sprop$stderr.chi.lower)
lines(sprop$stderr.chi.upper)
</code></pre>

<h2>
<a name="dev-install" class="anchor" href="#dev-install"><span class="octicon octicon-link"></span></a>Installing the Development Version</h2>

<p>Should you wish to install the development version
of this software, the 
<a href="http://cran.r-project.org/web/packages/devtools/" target="_blank"><code>devtools</code></a>
library
will be useful:</p>
<pre><code>install.packages("devtools", dependencies=TRUE)
library(devtools)
install_github("psd", username = "abarbour")
</code></pre>

</section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/abarbour" target="_blank">abarbour</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-34990319-4");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
